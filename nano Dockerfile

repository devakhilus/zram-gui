FROM fedora:43

# Install Qt6 + compiler + zram tools
RUN dnf update -y && \
    dnf install -y \
    gcc-c++ \
    qt6-qtbase-devel \
    pkgconfig \
    zram-generator \
    zram-generator-defaults \
    zramctl \
    bash \
    && dnf clean all

# Copy source
WORKDIR /app
COPY zram_gui.cpp .

# Compile
RUN g++ -std=c++20 -O2 zram_gui.cpp \
    $(pkg-config --cflags --libs Qt6Widgets Qt6Core Qt6Gui) \
    -o zram-gui

# Make executable
RUN chmod +x zram-gui

# Run as non-root (pkexec will elevate)
EXPOSE 8080
CMD ["./zram-gui"]

